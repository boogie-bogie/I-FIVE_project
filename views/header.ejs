<!doctype html>

</html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" width="device-width" initial-scale=1.0>
    <title>Ïö∞Î¶¨ 3Ï°∞Î•º ÏÜåÍ∞úÌï©ÎãàÎã§!</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Single+Day&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Single Day', 'cursive';
        }

        body {
            background-color: black;
            color: white;
        }

        footer {
            height: 188px;
            font-size: 29px;
        }

        #header_title {
            margin: 0px auto 0px auto;
            background-color: white;
            width: 90%;
            border: 1px solid white;
            border-radius: 5px
        }

        .members {
            width: 90%;
            margin: 15px auto 20px auto;
            height: 300px;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: space-around;
            color: black;
        }

        .members img {
            width: 200px;
            height: 271px;
            border: 1px solid rgba(255, 255, 255, 0);
            margin-bottom: 10px;
            border-radius: 10PX;
        }

        .intro {
            width: 1200px;
            height: 150px;
            border: 1px solid white;
            border-radius: 5px;
            margin: 20px 0px 0px 20px;
        }

        .namebox {
            margin: 15px auto 20px auto;
            height: 300px;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: space-between;
        }

        .namebox>text {
            width: 170px;
            height: 30px;
            border: 1px solid white;
        }

        .page2-textbox {
            margin: 100px 50px;
            padding-top: 50px;
            width: 685px;
            height: 600px;
            border: 5px solid white;
            color: white;
            border-radius: 15px;
        }

        .page2-textbox p {
            font-size: 25px;
            margin-bottom: 30px;
        }

        .page2-justbox {
            margin: 100px 50px;
            padding-top: 50px;
            width: 685px;
            height: 600px;
            border: 5px solid white;
            border-radius: 15px;
        }

        .page2-justbox td {
            border: 3px solid white;
            border-radius: 10px;
        }

        .carousel-item img {
            height: 500px;
        }

        .goalsContainer {
            font-size: 28px;
        }

        /* Ïó¨Í∏∞Î∂ÄÌÑ∞ Î∞©Î™ÖÎ°ù */
        .guestbook {
            height: 250px;
            color: white;

            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;

            background-position: center;
            background-size: cover;
        }

        .guestbook>button {
            width: 150px;
            height: 50px;
            background-color: transparent;
            color: white;
            border: 1px solid white;
            border-radius: 5px;

            margin-top: 20px;
        }

        .ourcards {
            color: white;
            width: 1200px;
            margin: 75px auto 54px auto;
        }

        .ourcommentbox {
            height: 440px;
            width: 600px;
            margin: 30px auto 0px auto;
            border: 4px solid rgb(45, 164, 103);
            ;
            padding: 20px;
            box-shadow: 0px 0px 20px 0px rgb(45, 164, 103);

            border-radius: 5px;
            font-size: 30px;
        }

        .ourbtn {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;

        }

        .ourbtn>button {
            margin-right: 5px;
        }

        .card {
            background-color: transparent;
            margin-right: 20px;
            color: white;
            font-size: 24px;
        }
    </style>

    <script type="module">
        // Firebase SDK ÎùºÏù¥Î∏åÎü¨Î¶¨ Í∞ÄÏ†∏Ïò§Í∏∞
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { collection, addDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { getDocs } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { doc, deleteDoc, updateDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        // Firebase Íµ¨ÏÑ± Ï†ïÎ≥¥ ÏÑ§Ï†ï
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyC_ZgQOmX6ggtWDytaIJn_-yqp22vJIhOs",
            authDomain: "sparta-54f1b.firebaseapp.com",
            projectId: "sparta-54f1b",
            storageBucket: "sparta-54f1b.appspot.com",
            messagingSenderId: "417143827658",
            appId: "1:417143827658:web:bffd7bac9f40fd269c5833",
            measurementId: "G-S0KNW7GGEK"
        };


        // Firebase Ïù∏Ïä§ÌÑ¥Ïä§ Ï¥àÍ∏∞Ìôî
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);


        // ÌåÄÎ™©Ìëú Ï∂îÍ∞Ä
        $("#postingbtn").click(async function () {
            let goal = $('#goal').val();

            let doc = {
                'goal': goal
            };
            await addDoc(collection(db, "goals"), doc);
            alert('Îì±Î°ù ÏôÑÎ£å!');
            window.location.reload();
        })

        $('#goalsContainer').empty();


        // ÌåÄÎ™©Ìëú Í∞ÄÏ†∏Ïò§Í∏∞
        let docs = await getDocs(collection(db, "goals"));
        docs.forEach((doc) => {
            let row = doc.data();
            let goalId = doc.id;

            let goal = row['goal'];

            // Í∞ÄÏ†∏Ïò®ÌõÑ ÌåÄÎ™©ÌëúÎ•º ÏÇ≠Ï†úÎ•º ÌïòÍ∏∞ÏúÑÌïú ÏûëÏóÖ
            // Í∏ÄÏùÑ Ï∂îÍ∞ÄÌïòÍ≥† Î≥¥Ïó¨Ïßà Îïå Ìï¥ÎãπÌïòÎäî Î≤ÑÌäºÏùÑ Ìïú divÏóê Î¨∂Ïñ¥ÏÑú ÎßåÎì§Ïñ¥Ï§ÄÎã§.
            let temp_html = `
            <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="${goalId}">
                <label class="form-check-label" for="${goalId}">
                    ${goal}
                </label>
                <button class="deletebtn" style="background-color: #ffffff00; border: none;">
                    <img src="./deletebtn.png" alt="ÏÇ≠Ï†úÎ≤ÑÌäº" width="20px" height="20px">
                </button>
            </div>`;
            $('#goalsContainer').append(temp_html)
        });


        // ÌåÄÎ™©Ìëú ÏÇ≠Ï†ú
        // ÏÇ≠Ï†ú Î≤ÑÌäºÏùÄ idÍ∞Ä goalsContainerÏù∏ divÏïàÏóê ÏûàÍ≥† Í∑∏ ÏïàÏóê ÏûàÎäî deletebtnÏùÑ ÌÅ¥Î¶≠ÌñàÏùÑ Îïå ÏûëÎèôÌïòÎèÑÎ°ù Ìï¥ÏïºÌï©ÎãàÎã§.
        // ‚Äª Î≤ÑÌäºÏùÄ idÍ∞Ä ÏïÑÎãàÎùº classÏù∏ Ïù¥Ïú† : Î≤ÑÌäºÏùÄ ÏïÑÏù¥ÎîîÍ∞Ä Î∞îÎÄî ÌïÑÏöîÏÑ±Ïù¥ ÏóÜÍ≥† ÌïòÎÇòÏùò Î≤ÑÌäºÏù¥ Ïó¨Îü¨ divÏïàÏóê ÏûàÏúºÎØÄÎ°ú idÎäî Ï§ëÏ≤©Ïù¥ ÏïàÎêòÎèÑÎ°ù ÌïòÎÇòÎßå ÏûàÏñ¥Ïïº ÌïòÏßÄÎßå classÎäî Ï§ëÎ≥µ ÎêòÏñ¥ÎèÑ ÏÉÅÍ¥ÄÏóÜÍ∏∞ ÎïåÎ¨∏
        // Í∑∏Îü∞ Îí§ ÌååÏù¥Ïñ¥ Ïä§ÌÜ†Ïñ¥Îäî ÎπÑÎèôÍ∏∞ ÏÑ±Ïù¥ Ï°¥Ïû¨ÌïòÎØÄÎ°ú async function Ï¶â, ÎπÑÎèôÍ∏∞ Ìï®ÏàòÎ•º Ïç®ÏïºÌï©ÎãàÎã§..
        $('#goalsContainer').on('click', '.deletebtn', async function () {

            // Ìï¥ÎãπÌïòÎäî Î≤ÑÌäºÏùò idÏ∞æÍ∏∞

            // thisÎäî ÎÇ¥Í∞Ä Î≤ÑÌäºÏùÑ ÎàÑÎ•∏ Í∑∏ ÏàúÍ∞ÑÏùò deletebtn.
            // closet()Î©îÏÑúÎìúÎäî Í∞ÄÏû• Í∞ÄÍπåÏù¥Ïóê ÏûàÎäî Î∂ÄÎ™®Ïù∏ ÌÅ¥ÎûòÏä§ form-chechÎ•º Ï∞æÏïÑÍ∞ëÎãàÎã§ (div).
            // Ï∞æÏùÄ formcheckÏóêÏÑú find()Î©îÏÑúÎìúÎ°ú ladelÏùÑ Ï∞æÍ≥† Í∑∏ ÏïàÏóê ÏûàÎäî forÏùò ÏÜçÏÑ±(attr)ÏùÑ Í∞ÄÏ†∏Ïò§Î©¥ Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Î¨∏ÏÑú(goals)Ïùò Ïù¥Î¶ÑÏùÑ Í∞ÄÏ†∏ Ïò¨Ïàò ÏûàÏäµÎãàÎã§.  
            let formCheck = $(this).closest('.form-check');
            let goalId = formCheck.find('label').attr('for');
            console.log(goalId);

            // Ïó¨Í∏∞ÍπåÏßÄ ÎêòÎ©¥ ÏÇ≠Ï†úÏôÑÎ£åÍ∞Ä Îú®ÎèÑÎ°ù ÌïòÏòÄÍ≥†
            alert('ÏÇ≠Ï†ú ÏôÑÎ£å!');

            // ÌååÏù¥Ïñ¥ Ïä§ÌÜ†Ïñ¥ÏóêÏÑú importÌïú  doc, deleteDoc Î•º ÏÇ¨Ïö©ÌïòÏó¨
            // docÏóê Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ï†ïÎ≥¥, Î¨∏ÏÑú Í≥µÍ∞Ñ, Î¨∏ÏÑú Ïù¥Î¶ÑÏùÑ Î≥¥ÎÇ¥ÏÑú deleteDocÎ•º ÏÇ¨Ïö©ÌïòÏó¨ ÏÇ≠Ï†úÌïòÍ≥† ÏúàÎèÑÏö∞Î•º reloadÌïòÏó¨ ÏÇ≠Ï†úÌïú ÎÇ¥Ïö©ÏùÑ ÏïàÎ≥¥Ïù¥Í≤å ÌïòÏòÄÏäµÎãàÎã§.
            await deleteDoc(doc(db, "goals", goalId));

            window.location.reload();
        });


        // Î∞©Î™ÖÎ°ù Ï∂îÍ∞Ä Î∞è Ïú†Ìö®ÏÑ± Ï≤¥ÌÅ¨
        $("#commentbtn").click(async function () {
            let name = $('#name').val();
            let content = $('#content').val();
            let email = $('#email').val();

            if (name == '' || content == '' || email == '') {

                alert("ÏûÖÎ†•ÎêòÏßÄ ÏïäÏùÄ ÏÇ¨Ìï≠Ïù¥ ÏûàÏäµÎãàÎã§!")
            }
            else {
                let doc = {
                    'name': name,
                    'content': content,
                    'email': email
                };
                await addDoc(collection(db, "comments"), doc);
                alert('Ï†ÄÏû• ÏôÑÎ£å!');
                window.location.reload();
            }
        });


        // Î∞©Î™ÖÎ°ù ÏàòÏ†ïÌïòÍ∏∞
        $('.ourcards').on('click', '.editbtn', async function () {
            let card = $(this).closest('.card.border-light.mb-3');
            let contentdox = card.attr('id');
            console.log(contentdox);

            let newContent = prompt("ÏàòÏ†ïÌï† ÌïúÎßàÎîîÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.")
            if (newContent == '') {
                alert('ÎÇ¥Ïö©Ïù¥ ÎπÑÏñ¥ ÏûàÏñ¥ ÏàòÏ†ïÌï† Ïàò ÏóÜÏäµÎãàÎã§!')
            }
            else {
                await updateDoc(doc(db, "comments", contentdox), { content: newContent });
                window.location.reload();
            }
        });


        // Î∞©Î™ÖÎ°ù ÏÇ≠Ï†úÌïòÍ∏∞
        $('#card').on('click', '.deletebtn', async function () {

            let card = $(this).closest('.card.border-light.mb-3');
            let contentdox = card.attr('id');
            console.log(contentdox);


            await deleteDoc(doc(db, "comments", contentdox));
            alert('ÏÇ≠Ï†ú ÏôÑÎ£å!');
            window.location.reload();
        });

        $("#savebtn").click(async function () {
            $('#commentbox').toggle();
        })

        $('#card').empty();


        // Î∞©Î™ÖÎ°ù Í∞ÄÏ†∏Ïò§Í∏∞
        let docs1 = await getDocs(collection(db, "comments"));
        docs1.forEach((doc) => {
            let row = doc.data();
            console.log(row);

            let name = row['name'];
            let content = row['content'];
            let email = row['email'];
            let contentdox = doc.id;

            let temp_html = `
            <div class="card border-light mb-3" id = "${contentdox}" style="max-width: 18rem; ;">
            <div class="card-header">${email}</div>
            <div class="card-body">
            <h5 class="card-title">${name}</h5>
            <p class="card-text">${content}</p>
            <button class="editbtn" style="background-color: #ffffff00; border: none;">
            <img src="./edit.png" alt="ÏàòÏ†ïÎ≤ÑÌäº" width="20px" height="20px">
            </button>
            <button class="deletebtn" style="background-color: #ffffff00; border: none;">
            <img src="./deletebtn.png" alt="ÏÇ≠Ï†úÎ≤ÑÌäº" width="20px" height="20px">
            </button>
            </div>
            </div>`;
            $('#card').append(temp_html);
        });



        //ÏöîÏùº Í∞ÄÏ†∏Ïò§Í∏∞

        var todayContainer = document.querySelector(".today");
        var d = new Date();
        console.log(d.getDay());


        var weekday = new Array(7);
        weekday[0] = "ÏùºÏöîÏùºü•∞";
        weekday[1] = "ÏõîÏöîÏùºüí™";
        weekday[2] = "ÌôîÏöîÏùºüòú";
        weekday[3] = "ÏàòÏöîÏùºüòå";
        weekday[4] = "Î™©ÏöîÏùºü§ó";
        weekday[5] = "Í∏àÏöîÏùºüíñ";
        weekday[6] = "ÌÜ†ÏöîÏùºüò¥";


        var n = weekday[d.getDay()];
        $('#day').text(n)

    </script>


</head>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
    crossorigin="anonymous"></script>

<body>

    <header style="margin-bottom: 10px; --bs-bg-opacity: .5;" class="p-3 text-bg-dark">
        <div class="container" class="w-100">
            <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
                <a href="/" class="d-flex align-items-center mb-2 mb-lg-0 text-white text-decoration-none">
                    <svg class="bi me-2" width="40" height="32" role="img" aria-label="Bootstrap">
                        <use xlink:href="#bootstrap"></use>
                    </svg>
                </a>

                <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
                    <li style="font-size: 50px;" class=" px-4 text-warning">I - FIVE</a></li>
                </ul>

                <div class="text-end">
                    <% if (is_logon) { %>
                        <span>
                            <%= nickname %>Îãò ÌôòÏòÅÌï©ÎãàÎã§.
                        </span>
                        <!-- Î°úÍ∑∏ÏïÑÏõÉ Î≤ÑÌäº -->
                        <form action="/logout" style="display: contents;">
                            <button class="btn btn-secondary" type="submit">Î°úÍ∑∏ÏïÑÏõÉ</button>
                        </form>
                        <% } else { %>
                            <!-- Î°úÍ∑∏Ïù∏ Î∞è ÌöåÏõêÍ∞ÄÏûÖ Î≤ÑÌäº -->
                            <button type="button" class="btn btn-outline-light me-2" data-bs-toggle="modal"
                                data-bs-target="#loginModal">Login</button>
                            <button type="button" class="btn btn-danger" data-bs-toggle="modal"
                            data-bs-target="#signinModal">Sign-up</button>
                            <% } %>

                                <!-- login Modal -->
                                <div style="color: black;" class="modal fade" id="loginModal" tabindex="-1"
                                    aria-labelledby="loginModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="exampleModalLabel">login</h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                    aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <form name="log_in" action="/login" method="post">
                                                    <!--  html Ï†ÑÏ≤¥ ÏòÅÏó≠ÏùÑ ÏßÄÏ†ïÌïòÎäî container -->
                                                    <div id="container">
                                                        <!--  login Ìèº ÏòÅÏó≠ÏùÑ : loginBox -->
                                                        <div id="loginBox">
                                                            <!-- Î°úÍ∑∏Ïù∏ ÌéòÏù¥ÏßÄ ÌÉÄÏù¥ÌãÄ -->
                                                            <!-- ÏïÑÏù¥Îîî, ÎπÑÎ≤à, Î≤ÑÌäº Î∞ïÏä§ -->
                                                            <div id="inputBox">
                                                                <div class="input-form-box" style="text-align: left;">
                                                                    <span>ÏïÑÏù¥Îîî </span><input type="text" name="id"
                                                                        class="form-control">
                                                                </div>
                                                                <div class="input-form-box" style="text-align: left;">
                                                                    <span>ÎπÑÎ∞ÄÎ≤àÌò∏ </span><input type="password"
                                                                        name="password" class="form-control">
                                                                </div>
                                                                <div style="margin-top: 20px;" class="button-login-box">
                                                                    <button type="submit" class="btn btn-primary btn-xs"
                                                                        style="width:100%">Î°úÍ∑∏Ïù∏</button>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary"
                                                    data-bs-dismiss="modal">Close</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <!-- sign_in Modal -->
                                <div style="color: black;" class="modal fade" id="signinModal" tabindex="-1"
                                    aria-labelledby="signinModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="signinModalLabel">login</h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                    aria-label="Close"></button>
                                            </div>
                                            <div style="text-align: left;" class="modal-body">
                                                <form action="/addmember" method="post">
                                                    <fieldset>
                                                        <legend>ÌöåÏõêÍ∞ÄÏûÖ</legend>
                                                        <div>
                                                            <label for="id"><strong>ID :</strong></label required>
                                                            <input type="text" name="id" id="id">
                                                        </div>
                                                        <div>
                                                            <label for="name"><strong>NAME :</strong></label required>
                                                            <input type="text" name="name" id="name">
                                                        </div>
                                                        <div>
                                                            <label for="email"><strong>email : </strong>
                                                                <input type="text" name="email" id="email" size="35" placeholder="Ïù¥Î©îÏùºÏûëÏÑ±" required>
                                                            </label>
                                                        </div>
                                                        <div>
                                                            <label for="password"><strong>PASSWORD :</strong>
                                                                <input type="password" name="password" id="password"
                                                                    size="35"required>
                                                            </label>
                                                        </div>
                                                    </fieldset>
                                                    <div style="text-align: right;">
                                                        <button  type="submit">ÌöåÏõêÍ∞ÄÏûÖ</button>
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary"
                                                    data-bs-dismiss="modal">Close</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                </div>
            </div>
        </div>
    </header>